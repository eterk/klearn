package org.eter.klearn
package stack

import org.eterk.klearn.LeetCode

import scala.annotation.tailrec
import scala.collection.mutable
import scala.util.Try

object ValidateStackSequences946 {


  def apply(pushed: Array[Int], popped: Array[Int]): Boolean = {

    s1(pushed, popped)
  }

  /**
   * 经过多次调试后拼写完成  50% 50%
   *
   * @return
   */
  def s1(pushed: Array[Int], popped: Array[Int]): Boolean = {

    var i = 0 // initialize a variable to keep track of the index of pushed array
    val container = new mutable.Stack[Int]() // create a mutable stack to simulate the push and pop operations
    var j = 0 // initialize a variable to keep track of the index of popped array
    var currentJ = popped.head // get the first element of popped array
    var top = pushed.head // get the first element of pushed array

    while (i < pushed.length) { // loop through the pushed array
      container.push(pushed(i)) // push the current element to the stack
      top = container.top // update the top element of the stack
      while (currentJ == top) { // loop while the current element of popped array matches the top element of the stack
        container.pop() // pop the top element from the stack
        if (container.nonEmpty) {
          top = container.top // update the top element if the stack is not empty
        }
        if (j < popped.length - 1) {
          j += 1 // increment j if it is not at the end of popped array
          currentJ = popped(j) // update the current element of popped array
        } else {
          top = -1 // set top to -1 if j reaches the end of popped array
        }

      }

      i += 1 // increment i after each iteration
    }
    container.isEmpty // return true if the stack is empty after looping through both arrays, or false otherwise
  }


  /**
   * 50% 100%
   */
  def s2(pushed: Array[Int], popped: Array[Int]): Boolean = {

    @annotation.tailrec
    def dfs(stack: Seq[Int], idx: Int): (Seq[Int], Int) = {
      if (idx >= pushed.length || !stack.headOption.contains(popped(idx))) (stack, idx)
      else dfs(stack.tail, idx + 1)
    }
    /* define a tail recursive function that takes a stack and an index as parameters
       and returns a tuple of updated stack and index
       if the head option of the stack does not match with
       or does not exist for
       corresponding value in popped array at given index,
       return them as they are,
       otherwise call itself recursively with tail of stack and incremented index */
    pushed.foldLeft(Seq.empty[Int], 0) {
      /* use foldLeft method on pushed array with an initial value
                                               consisting an empty sequence as stack and zero as index */
      case ((stack, idx), n) => dfs(n +: stack, idx)
      /* for each element n in pushed array,
         call dfs function with n prepended to current stack and current index */
    }._1.isEmpty /* return true if final updated stack is empty after folding through all elements in pushed array,
                   or false otherwise */
  }

  /**
   * 100% 100%
   */
  def s3(pushed: Array[Int], popped: Array[Int]): Boolean = {
    var i = 0 // Intialise one pointer pointing on pushed array
    var j = 0 // Intialise one pointer pointing on popped array

    //    import scala.collection.JavaConversions._
    for (v <- pushed) {
      pushed({
        i += 1;
        i - 1
      }) = v // using pushed as the stack.

      while ( {
        i > 0 && (pushed(i - 1) == popped(j))
      }) { // pushed[i - 1] values equal to popped[j];
        i -= 1 // decrement i

        j += 1 // increment j

      }
    }
    i == 0 // Since pushed is a permutation of popped so at the end we are supposed to be left with an empty stack

  }

  def main(args: Array[String]): Unit = {

    println(s3(Array(1, 2, 3, 4, 5), Array(4, 5, 3, 2, 1)))


  }


}

object BasicCalculator224 extends LeetCode[String, Int] {
  override def no: Int = 224

  override def desc: String = "给你一个字符串表达式 s ，请你实现一个基本计算器来计算并返回它的值。"

  override def domain(input: String): Boolean = input.nonEmpty

  override def stdIO: Seq[(String, Int)] = {
    Seq(
      ("1 + 1", 2),
      (" 2-1 + 2 ", 3),
      ("-(-2)", 2),
      ("1-(-2)", 3),
      ("-(-2+2)", 0),
      ("(-2+2)", 0),
      ("(1+(4-(5 +2)+ 3))+(6+8)", 15),
      ("2-4-(8+2-6+(8+4-(1)+8-10))", -15),
      ("(1+( 4+5+ 2)-3)+(6+8)", 23)
    )
  }

  override def set: Map[String, String => Int] = {
    Map(
      "默认方法" -> calculate1
    )
  }

  def minusPlus(mid: String): Int = {

    val tmp = new StringBuilder("")
    var plus = 1
    val str = mid.replaceAll("--", "+")
    val iter = str.iterator
    var res = 0
    while (iter.hasNext) {
      iter.next match {
        case '+' =>
          val last =
            if (tmp.isEmpty) {
              0
            } else {
              tmp.result().toInt
            }
          res = res + plus * last
          tmp.clear()
          plus = 1
        case '-' =>
          if (tmp.isEmpty) {
            tmp.append('-')
          } else {
            res = res + (plus * tmp.result().toInt)
            tmp.clear()
            plus = -1
          }

        case o => tmp.append(o)
      }
    }
    res = res + (plus * tmp.result().toInt)
    res
  }

  def calculate(s: String): Int = {
    var str = s.replaceAll(" ", "")
    var res = 0
    var flag = true

    while (flag) {
      if (str.contains('(')) {
        val b = str.lastIndexOf('(')
        val e = str.indexOf(')', b)
        val mid = str.slice(b + 1, e)
        val res = minusPlus(mid)
        str = str.slice(0, b) + res + str.slice(e, str.length)
      } else {
        res = minusPlus(str.replaceAll("\\)", ""))
        flag = false
      }
    }
    res
  }

  def calculate1(src: String): Int = {
    val plus = (a: Int, b: Int) => {
      println(a + " + " + b)
      a + b
    }
    val minus = (a: Int, b: Int) => {
      println(a + " - " + b)
      a - b
    }
    val s = src.replaceAll(" ", "")

    def state(i: Int, tmp: StringBuilder): Int = {

      val sta = if (i >= 2) {
        s.slice(i - 2, i + 1) match {
          case "-(-" => 0
          case _ => 1
        }
      } else {
        1
      }
      if (sta == 1) {
        if (tmp.isEmpty) {
          1
        } else {
          2
        }
      } else {
        0
      }

    }

    var tmp = new StringBuilder("")

    def rec(from: Int, resInit: Int, signInit: (Int, Int) => Int): Int = {
      if (s.isEmpty) return resInit
      var res = resInit
      var sign = signInit

      def compute(state: Int): Unit = {
        val lastValue = state match {
          case 0 => tmp.addOne('-')
          case 1 =>
          case 2 =>
            println(tmp.toString().toInt)
            res = sign(res, tmp.toString().toInt)
            tmp.clear()
        }

      }

      for (i <- (from until s.length)) {

        val sta = state(i, tmp)
        s(i) match {
          case '(' => signInit(resInit, rec(i + 1, res, sign))
          case ')' => compute(sta)
          case '+' => compute(sta)
            sign = plus
          case '-' =>
            compute(sta)
            sign = minus
          case o =>
            tmp.append(o)
        }
        if (i == s.length - 1) {
          compute(state(i, tmp))
        }
      }

      res
    }

    rec(0, 0, plus)
  }


}

object ReverseInteger7 extends LeetCode[Int, Int] {


  override def no: Int = 7

  override def desc: String = "给出一个 32 位的有符号整数，你需要将这个整数中每位上的数字进行反转。"

  override def domain(input: Int): Boolean = input >= Int.MinValue && input <= Int.MaxValue

  override def stdIO: Seq[(Int, Int)] = {
    Seq(
      (123, 321),
      (-123, -321),
      (120, 21),
      (Int.MaxValue, 0),
      (Int.MinValue, 0),
    )
  }

  override def set: Map[String, Int => Int] = {
    Map(
      "字符串除以10取余" -> reverse,
      "数字除以10取余" -> reverse2
    )
  }

  import scala.annotation.tailrec
  import scala.util.Try

  //官方解答
  def reverse2(x: Int): Int = {
    var res = 0
    var input = x

    while (input != 0) {
      if (res < Int.MinValue / 10 || res > Int.MaxValue / 10) {
        input = 0
        res = 0
      } else {
        val digit = input % 10
        input /= 10
        res = res * 10 + digit
      }
    }
    res


  }

  def reverse(x: Int): Int = {
    val abs = Math.abs(x)

    @tailrec
    def rec(num: Int, current: String): String = {
      if (num < 10) return current + num
      val left = (num % 10).toString
      //      println(left)
      rec(num / 10, current + left)
    }


    val str = rec(abs, "")
    //    println(str + "------")

    Try {
      if (x < 0) {
        ("-" + str).toInt
      } else {
        str.toInt
      }
    }.recover(e => 0)
      .get


  }
}


object StringToIntMyAtoi8 extends LeetCode[String, Int] {


  override def no: Int = 8

  override def desc: String = "https://leetcode.cn/problems/string-to-integer-atoi/"

  override def domain(input: String): Boolean = true

  override def stdIO: Seq[(String, Int)] = {
    Seq(
      ("1337c0d3", 1337),
      ("0-1", 0),
      ("ww 989", 0),
      ("  -12", -12),
      (" 12", 12),
      ("   -042", -42),
      ("0  123", 0),
      ("-91283472332", -2147483648),
      ("-2147483648", -2147483648)
    )
  }

  override def set: Map[String, String => Int] = {
    Map(
      "默认" -> myAtoi,
    )
  }

  def myAtoi(s: String): Int = {
    var sign = 1
    var res = new scala.collection.mutable.StringBuilder()
    val iter = s.iterator
    var flag = 0
    while (iter.hasNext && flag != 2) {
      val next = iter.next()

      if (flag == 0 || flag == -1) {
        next match {
          case ' ' if flag == 0 =>
          case '0' => flag = -1
          case '-' if flag != -1 =>
            sign = -1
            flag = 1
          case '+' if flag != -1 => flag = 1
          case c if c > '0' && c <= '9' =>
            res.append(c)
            flag = 1
          case o => flag = 2
        }
      }
      else {
        next match {
          case c if c >= '0' && c <= '9' => res.append(c)
          case _ => flag = 2
        }
      }


    }
    if (res.isEmpty) {
      0
    } else {
      val v = res.result().toDouble

      if (sign == 1) {
        if (v > Int.MaxValue) {
          Int.MaxValue
        } else {
          v.toInt
        }
      } else {
        if (v >= Int.MaxValue.toDouble + 1) {
          Int.MinValue
        } else {
          sign * v.toInt
        }

      }

    }

  }


}

object CountAndSay38 extends LeetCode[Int, String] {
  override def no: Int = 38

  override def desc: String = "给定一个正整数 n ，输出外观数列的第 n 项。"

  override def domain(input: Int): Boolean = input >= 1 && input <= 30

  override def stdIO: Seq[(Int, String)] = {
    Seq(
      (1, "1"),
      (4, "1211")
    )
  }

  override def set: Map[String, Int => String] = {
    Map(
      "递归" -> countAndSay,
      "枚举" -> enumFunc // 官方给的解法 2333
    )
  }

  def enumFunc(n: Int): String = {
    n match {
      case 1 => "1"
      case 2 => "11"
      case 3 => "21"
      case 4 => "1211"
      case 5 => "111221"
      case 6 => "312211"
      case 7 => "13112221"
      case 8 => "1113213211"
      case 9 => "31131211131221"
      case 10 => "13211311123113112211"
      case 11 => "11131221133112132113212221"
      case 12 => "3113112221232112111312211312113211"
      case 13 => "1321132132111213122112311311222113111221131221"
      case 14 => "11131221131211131231121113112221121321132132211331222113112211"
      case 15 => "311311222113111231131112132112311321322112111312211312111322212311322113212221"
      case 16 => "132113213221133112132113311211131221121321131211132221123113112221131112311332111213211322211312113211"
      case 17 => "11131221131211132221232112111312212321123113112221121113122113111231133221121321132132211331121321231231121113122113322113111221131221"
      case 18 => "31131122211311123113321112131221123113112211121312211213211321322112311311222113311213212322211211131221131211132221232112111312111213111213211231131122212322211331222113112211"
      case 19 => "1321132132211331121321231231121113112221121321132122311211131122211211131221131211132221121321132132212321121113121112133221123113112221131112311332111213122112311311123112111331121113122112132113213211121332212311322113212221"
      case 20 => "11131221131211132221232112111312111213111213211231132132211211131221131211221321123113213221123113112221131112311332211211131221131211132211121312211231131112311211232221121321132132211331121321231231121113112221121321133112132112312321123113112221121113122113121113123112112322111213211322211312113211"
      case 21 => "311311222113111231133211121312211231131112311211133112111312211213211312111322211231131122211311122122111312211213211312111322211213211321322113311213212322211231131122211311123113223112111311222112132113311213211221121332211211131221131211132221232112111312111213111213211231132132211211131221232112111312211213111213122112132113213221123113112221131112311311121321122112132231121113122113322113111221131221"
      case 22 => "132113213221133112132123123112111311222112132113311213211231232112311311222112111312211311123113322112132113213221133122112231131122211211131221131112311332211211131221131211132221232112111312111213322112132113213221133112132113221321123113213221121113122123211211131221222112112322211231131122211311123113321112131221123113111231121113311211131221121321131211132221123113112211121312211231131122211211133112111311222112111312211312111322211213211321322113311213211331121113122122211211132213211231131122212322211331222113112211"
      case 23 => "111312211312111322212321121113121112131112132112311321322112111312212321121113122112131112131221121321132132211231131122211331121321232221121113122113121113222123112221221321132132211231131122211331121321232221123113112221131112311332111213122112311311123112112322211211131221131211132221232112111312211322111312211213211312111322211231131122111213122112311311221132211221121332211213211321322113311213212312311211131122211213211331121321123123211231131122211211131221131112311332211213211321223112111311222112132113213221123123211231132132211231131122211311123113322112111312211312111322212321121113122123211231131122113221123113221113122112132113213211121332212311322113212221"
      case 24 => "3113112221131112311332111213122112311311123112111331121113122112132113121113222112311311221112131221123113112221121113311211131122211211131221131211132221121321132132212321121113121112133221123113112221131112311332111213213211221113122113121113222112132113213221232112111312111213322112132113213221133112132123123112111311222112132113311213211221121332211231131122211311123113321112131221123113112221132231131122211211131221131112311332211213211321223112111311222112132113212221132221222112112322211211131221131211132221232112111312111213111213211231132132211211131221232112111312211213111213122112132113213221123113112221133112132123222112111312211312112213211231132132211211131221131211132221121311121312211213211312111322211213211321322113311213212322211231131122211311123113321112131221123113112211121312211213211321222113222112132113223113112221121113122113121113123112112322111213211322211312113211"
      case 25 => "132113213221133112132123123112111311222112132113311213211231232112311311222112111312211311123113322112132113212231121113112221121321132132211231232112311321322112311311222113111231133221121113122113121113221112131221123113111231121123222112132113213221133112132123123112111312111312212231131122211311123113322112111312211312111322111213122112311311123112112322211211131221131211132221232112111312111213111213211231132132211211131221232112111312212221121123222112132113213221133112132123123112111311222112132113213221132213211321322112311311222113311213212322211211131221131211221321123113213221121113122113121132211332113221122112133221123113112221131112311332111213122112311311123112111331121113122112132113121113222112311311221112131221123113112221121113311211131122211211131221131211132221121321132132212321121113121112133221123113112221131112212211131221121321131211132221123113112221131112311332211211133112111311222112111312211311123113322112111312211312111322212321121113121112133221121321132132211331121321231231121113112221121321132122311211131122211211131221131211322113322112111312211322132113213221123113112221131112311311121321122112132231121113122113322113111221131221"
      case 26 => "1113122113121113222123211211131211121311121321123113213221121113122123211211131221121311121312211213211321322112311311222113311213212322211211131221131211221321123113213221121113122113121113222112131112131221121321131211132221121321132132211331121321232221123113112221131112311322311211131122211213211331121321122112133221121113122113121113222123211211131211121311121321123113111231131122112213211321322113311213212322211231131122211311123113223112111311222112132113311213211221121332211231131122211311123113321112131221123113111231121113311211131221121321131211132221123113112211121312211231131122113221122112133221121113122113121113222123211211131211121311121321123113213221121113122113121113222113221113122113121113222112132113213221232112111312111213322112311311222113111221221113122112132113121113222112311311222113111221132221231221132221222112112322211213211321322113311213212312311211131122211213211331121321123123211231131122211211131221131112311332211213211321223112111311222112132113213221123123211231132132211231131122211311123113322112111312211312111322111213122112311311123112112322211213211321322113312211223113112221121113122113111231133221121321132132211331121321232221123123211231132132211231131122211331121321232221123113112221131112311332111213122112311311123112112322211211131221131211132221232112111312111213111213211231132132211211131221131211221321123113213221123113112221131112211322212322211231131122211322111312211312111322211213211321322113311213211331121113122122211211132213211231131122212322211331222113112211"
      case 27 => "31131122211311123113321112131221123113111231121113311211131221121321131211132221123113112211121312211231131122211211133112111311222112111312211312111322211213211321322123211211131211121332211231131122211311122122111312211213211312111322211231131122211311123113322112111331121113112221121113122113111231133221121113122113121113222123211211131211121332211213211321322113311213211322132112311321322112111312212321121113122122211211232221123113112221131112311332111213122112311311123112111331121113122112132113311213211321222122111312211312111322212321121113121112133221121321132132211331121321132213211231132132211211131221232112111312212221121123222112132113213221133112132123123112111311222112132113311213211231232112311311222112111312211311123113322112132113212231121113112221121321132122211322212221121123222112311311222113111231133211121312211231131112311211133112111312211213211312111322211231131122211311123113322113223113112221131112311332211211131221131211132211121312211231131112311211232221121321132132211331221122311311222112111312211311123113322112132113213221133122211332111213112221133211322112211213322112111312211312111322212321121113121112131112132112311321322112111312212321121113122112131112131221121321132132211231131122211331121321232221121113122113121122132112311321322112111312211312111322211213111213122112132113121113222112132113213221133112132123222112311311222113111231132231121113112221121321133112132112211213322112111312211312111322212311222122132113213221123113112221133112132123222112111312211312111322212321121113121112133221121311121312211213211312111322211213211321322123211211131211121332211213211321322113311213212312311211131122211213211331121321122112133221123113112221131112311332111213122112311311123112111331121113122112132113121113222112311311222113111221221113122112132113121113222112132113213221133122211332111213322112132113213221132231131122211311123113322112111312211312111322212321121113122123211231131122113221123113221113122112132113213211121332212311322113212221"
      case 28 => "13211321322113311213212312311211131122211213211331121321123123211231131122211211131221131112311332211213211321223112111311222112132113213221123123211231132132211231131122211311123113322112111312211312111322111213122112311311123112112322211213211321322113312211223113112221121113122113111231133221121321132132211331121321232221123123211231132132211231131122211331121321232221123113112221131112311332111213122112311311123112112322211211131221131211132221232112111312211322111312211213211312111322211231131122111213122112311311221132211221121332211213211321322113311213212312311211131122211213211331121321123123211231131122211211131221232112111312211312113211223113112221131112311332111213122112311311123112112322211211131221131211132221232112111312211322111312211213211312111322211231131122111213122112311311221132211221121332211211131221131211132221232112111312111213111213211231132132211211131221232112111312211213111213122112132113213221123113112221133112132123222112111312211312112213211231132132211211131221131211322113321132211221121332211213211321322113311213212312311211131122211213211331121321123123211231131122211211131221131112311332211213211321322113311213212322211322132113213221133112132123222112311311222113111231132231121113112221121321133112132112211213322112111312211312111322212311222122132113213221123113112221133112132123222112111312211312111322212311322123123112111321322123122113222122211211232221123113112221131112311332111213122112311311123112111331121113122112132113121113222112311311221112131221123113112221121113311211131122211211131221131211132221121321132132212321121113121112133221123113112221131112212211131221121321131211132221123113112221131112311332211211133112111311222112111312211311123113322112111312211312111322212321121113121112133221121321132132211331121321132213211231132132211211131221232112111312212221121123222112311311222113111231133211121321321122111312211312111322211213211321322123211211131211121332211231131122211311123113321112131221123113111231121123222112111331121113112221121113122113111231133221121113122113121113221112131221123113111231121123222112111312211312111322212321121113121112131112132112311321322112111312212321121113122122211211232221121321132132211331121321231231121113112221121321133112132112312321123113112221121113122113111231133221121321132132211331221122311311222112111312211311123113322112111312211312111322212311322123123112112322211211131221131211132221132213211321322113311213212322211231131122211311123113321112131221123113112211121312211213211321222113222112132113223113112221121113122113121113123112112322111213211322211312113211"
      case 29 => "11131221131211132221232112111312111213111213211231132132211211131221232112111312211213111213122112132113213221123113112221133112132123222112111312211312112213211231132132211211131221131211132221121311121312211213211312111322211213211321322113311213212322211231131122211311123113223112111311222112132113311213211221121332211211131221131211132221231122212213211321322112311311222113311213212322211211131221131211132221232112111312111213322112131112131221121321131211132221121321132132212321121113121112133221121321132132211331121321231231121113112221121321133112132112211213322112311311222113111231133211121312211231131122211322311311222112111312211311123113322112132113212231121113112221121321132122211322212221121123222112111312211312111322212321121113121112131112132112311321322112111312212321121113122112131112131221121321132132211231131122111213122112311311222113111221131221221321132132211331121321231231121113112221121321133112132112211213322112311311222113111231133211121312211231131122211322311311222112111312211311123113322112132113212231121113112221121321132122211322212221121123222112311311222113111231133211121312211231131112311211133112111312211213211312111322211231131122111213122112311311222112111331121113112221121113122113121113222112132113213221232112111312111213322112311311222113111221221113122112132113121113222112311311222113111221132221231221132221222112112322211211131221131211132221232112111312111213111213211231132132211211131221232112111312211213111213122112132113213221123113112221133112132123222112111312211312111322212321121113121112133221132211131221131211132221232112111312111213322112132113213221133112132113221321123113213221121113122123211211131221222112112322211231131122211311123113321112132132112211131221131211132221121321132132212321121113121112133221123113112221131112311332111213211322111213111213211231131211132211121311222113321132211221121332211213211321322113311213212312311211131122211213211331121321123123211231131122211211131221131112311332211213211321223112111311222112132113213221123123211231132132211231131122211311123113322112111312211312111322111213122112311311123112112322211213211321322113312211223113112221121113122113111231133221121321132132211331121321232221123123211231132132211231131122211331121321232221123113112221131112311332111213122112311311123112112322211211131221131211132221232112111312211322111312211213211312111322211231131122111213122112311311221132211221121332211213211321322113311213212312311211131211131221223113112221131112311332211211131221131211132211121312211231131112311211232221121321132132211331121321231231121113112221121321133112132112211213322112312321123113213221123113112221133112132123222112311311222113111231132231121113112221121321133112132112211213322112311311222113111231133211121312211231131112311211133112111312211213211312111322211231131122111213122112311311221132211221121332211211131221131211132221232112111312111213111213211231132132211211131221232112111312211213111213122112132113213221123113112221133112132123222112111312211312111322212311222122132113213221123113112221133112132123222112311311222113111231133211121321132211121311121321122112133221123113112221131112311332211322111312211312111322212321121113121112133221121321132132211331121321231231121113112221121321132122311211131122211211131221131211322113322112111312211322132113213221123113112221131112311311121321122112132231121113122113322113111221131221"
      case 30 => "3113112221131112311332111213122112311311123112111331121113122112132113121113222112311311221112131221123113112221121113311211131122211211131221131211132221121321132132212321121113121112133221123113112221131112212211131221121321131211132221123113112221131112311332211211133112111311222112111312211311123113322112111312211312111322212321121113121112133221121321132132211331121321132213211231132132211211131221232112111312212221121123222112311311222113111231133211121321321122111312211312111322211213211321322123211211131211121332211231131122211311123113321112131221123113111231121123222112111331121113112221121113122113111231133221121113122113121113221112131221123113111231121123222112111312211312111322212321121113121112131112132112311321322112111312212321121113122122211211232221121321132132211331121321231231121113112221121321132132211322132113213221123113112221133112132123222112111312211312112213211231132132211211131221131211322113321132211221121332211231131122211311123113321112131221123113111231121113311211131221121321131211132221123113112211121312211231131122211211133112111311222112111312211312111322211213211321223112111311222112132113213221133122211311221122111312211312111322212321121113121112131112132112311321322112111312212321121113122122211211232221121321132132211331121321231231121113112221121321132132211322132113213221123113112221133112132123222112111312211312112213211231132132211211131221131211322113321132211221121332211213211321322113311213212312311211131122211213211331121321123123211231131122211211131221131112311332211213211321223112111311222112132113213221123123211231132132211231131122211311123113322112111312211312111322111213122112311311123112112322211213211321322113312211223113112221121113122113111231133221121321132132211331222113321112131122211332113221122112133221123113112221131112311332111213122112311311123112111331121113122112132113121113222112311311221112131221123113112221121113311211131122211211131221131211132221121321132132212321121113121112133221123113112221131112311332111213122112311311123112112322211322311311222113111231133211121312211231131112311211232221121113122113121113222123211211131221132211131221121321131211132221123113112211121312211231131122113221122112133221121321132132211331121321231231121113121113122122311311222113111231133221121113122113121113221112131221123113111231121123222112132113213221133112132123123112111312211322311211133112111312211213211311123113223112111321322123122113222122211211232221121113122113121113222123211211131211121311121321123113213221121113122123211211131221121311121312211213211321322112311311222113311213212322211211131221131211221321123113213221121113122113121113222112131112131221121321131211132221121321132132211331121321232221123113112221131112311322311211131122211213211331121321122112133221121113122113121113222123112221221321132132211231131122211331121321232221121113122113121113222123211211131211121332211213111213122112132113121113222112132113213221232112111312111213322112132113213221133112132123123112111311222112132113311213211221121332211231131122211311123113321112131221123113112221132231131122211211131221131112311332211213211321223112111311222112132113212221132221222112112322211211131221131211132221232112111312111213111213211231131112311311221122132113213221133112132123222112311311222113111231132231121113112221121321133112132112211213322112111312211312111322212321121113121112131112132112311321322112111312212321121113122122211211232221121311121312211213211312111322211213211321322123211211131211121332211213211321322113311213211322132112311321322112111312212321121113122122211211232221121321132132211331121321231231121113112221121321133112132112312321123113112221121113122113111231133221121321132122311211131122211213211321222113222122211211232221123113112221131112311332111213122112311311123112111331121113122112132113121113222112311311221112131221123113112221121113311211131122211211131221131211132221121321132132212321121113121112133221123113112221131112311332111213213211221113122113121113222112132113213221232112111312111213322112132113213221133112132123123112111312211322311211133112111312212221121123222112132113213221133112132123222113223113112221131112311332111213122112311311123112112322211211131221131211132221232112111312111213111213211231132132211211131221131211221321123113213221123113112221131112211322212322211231131122211322111312211312111322211213211321322113311213211331121113122122211211132213211231131122212322211331222113112211"
    }

  }

  def countAndSay(n: Int): String = {
    @scala.annotation.tailrec
    def rec(context: String, num: Int): String = {
      if (num == 0) return context
      val iter = context.tail.iterator
      val res = collection.mutable.Buffer[(Char, Int)](context.head -> 1)
      while (iter.hasNext) {
        val next = iter.next()
        val index = res.length - 1
        val (last, num) = res(index)
        if (next == last) {
          res.update(index, (next, num + 1))
        } else {
          res.append(next -> 1)
        }
      }
      val nexStr = res.map(kv => kv._2.toString + kv._1).mkString("")
      println(s"case ${n - num + 1}=> \"${nexStr}\"")
      rec(nexStr, num - 1)
    }

    rec("1", n - 1)

  }
}

import scala.annotation.tailrec

case class ListNode(var x: Int, var next: ListNode) {
  override def toString: String = {
    var node = this
    val res = new StringBuilder(x)
    while (node.next != null) {
      res.append(node.x + ",")
      node = node.next
    }
    res.result()
  }
}

object ListNode {

  def apply(seq: Seq[Int]): ListNode = {
    if (seq.isEmpty) return ListNode(0, null)
    val res = ListNode(seq.head, null)
    var node = res
    val iter = seq.tail.iterator
    while (iter.hasNext) {
      node.next = ListNode(iter.next(), null)
      node = node.next
    }
    res
  }
}

object RotateList61 extends LeetCode[(ListNode, Int), ListNode] {


  override def no: Int = 61

  override def desc: String = "给定一个链表，旋转链表，将链表每个节点向右移动 k 个位置，其中 k 是非负数。"

  override def domain(input: (ListNode, Int)): Boolean = true

  override def stdIO: Seq[((ListNode, Int), ListNode)] = {
    Seq(
      ((ListNode(Seq(1, 2, 3, 4, 5)), 2), ListNode(Seq(4, 5, 1, 2, 3))),
      ((ListNode(Seq(0, 1, 2)), 4), ListNode(Seq(2, 0, 1)))
    )
  }

  override def set: Map[String, ((ListNode, Int)) => ListNode] = {
    Map(
      "默认方法" -> rotateRight
    )
  }

  def rotateRight(head: ListNode, k: Int): ListNode = {

    var len = 1
    var last = head

    while (last.next != null) {
      last = last.next
      len += 1
    }



    var newHead = head
    val realK = k % len

    var next = head // 中间变量
    last = head //复位
    var i = 1 //索引复位
    while (last.next != null) {

      next = last.next
      if (i == realK-1) {
        newHead = next.next
        println(newHead)
        println(next)
        last.next = null
      }
      last = next.next
      i += 1
    }

    newHead.next = head

    newHead

  }

}
